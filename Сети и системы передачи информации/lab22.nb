(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     10712,        293]
NotebookOptionsPosition[     10186,        271]
NotebookOutlinePosition[     10539,        287]
CellTagsIndexPosition[     10496,        284]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"{", 
  RowBox[{"\"\<Ac\>\"", ",", 
   RowBox[{
    RowBox[{"Ac", "=", "2"}], ";", 
    RowBox[{"Slider", "[", 
     RowBox[{
      RowBox[{"Dynamic", "[", "Ac", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "1000"}]}], "]"}]}], ",", 
   RowBox[{"Dynamic", "[", "Ac", "]"}]}], "}"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{"\"\<Oc\>\"", ",", 
   RowBox[{
    RowBox[{"Oc", "=", "10"}], ";", 
    RowBox[{"Slider", "[", 
     RowBox[{
      RowBox[{"Dynamic", "[", "Oc", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "100"}], ",", "100"}], "}"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "1000"}]}], "]"}]}], ",", 
   RowBox[{"Dynamic", "[", "Oc", "]"}]}], "}"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{"\"\<Am\>\"", ",", 
   RowBox[{
    RowBox[{"Am", "=", "2"}], ";", 
    RowBox[{"Slider", "[", 
     RowBox[{
      RowBox[{"Dynamic", "[", "Am", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "1000"}]}], "]"}]}], ",", 
   RowBox[{"Dynamic", "[", "Am", "]"}]}], "}"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{"\"\<Om\>\"", ",", 
   RowBox[{
    RowBox[{"Om", "=", "2"}], ";", 
    RowBox[{"Slider", "[", 
     RowBox[{
      RowBox[{"Dynamic", "[", "Om", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "100"}], ",", "100"}], "}"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "1000"}]}], "]"}]}], ",", 
   RowBox[{"Dynamic", "[", "Om", "]"}]}], "}"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"\"\<f\>\"", ",", 
    RowBox[{
     RowBox[{"f", "=", "0"}], ";", 
     RowBox[{"Slider", "[", 
      RowBox[{
       RowBox[{"Dynamic", "[", "f", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "1000"}]}], "]"}]}], ",", 
    RowBox[{"Dynamic", "[", "f", "]"}]}], "}"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Uc", "[", "x_", "]"}], ":=", 
   RowBox[{"Ac", "*", 
    RowBox[{"Sin", "[", 
     RowBox[{"Oc", "*", "x"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Um", "[", "x_", "]"}], ":=", 
   RowBox[{"Am", "*", 
    RowBox[{"Sin", "[", 
     RowBox[{
      RowBox[{"Om", "*", "x"}], "+", "f"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Uam", "[", "x_", "]"}], ":=", 
    RowBox[{
     RowBox[{"Uc", "[", "x", "]"}], "*", 
     RowBox[{"Um", "[", "x", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"r", "=", 
    RowBox[{"Range", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "3"}], "Pi"}], ",", 
      RowBox[{"3", "Pi"}], ",", 
      RowBox[{"Pi", "/", "256"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cardata", ",", "src", ",", "data"}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Uc", "[", "r", "]"}], ",", 
       RowBox[{"Um", "[", "r", "]"}], ",", 
       RowBox[{"Uam", "[", "r", "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
    
    RowBox[{"filtered", "=", 
     RowBox[{"HighpassFilter", "[", 
      RowBox[{
       RowBox[{"LowpassFilter", "[", 
        RowBox[{
         RowBox[{"data", "*", "cardata"}], ",", ".012"}], "]"}], ",", 
       ".012"}], "]"}]}], ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Dynamic", "[", 
  RowBox[{"ListLinePlot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Um", "[", "r", "]"}], ",", 
      RowBox[{"HighpassFilter", "[", 
       RowBox[{
        RowBox[{"LowpassFilter", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Uam", "[", "r", "]"}], "*", 
           RowBox[{"Uc", "[", "r", "]"}]}], ",", ".012"}], "]"}], ",", 
        ".012"}], "]"}]}], "}"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "1000"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Periodogram", "[", 
       RowBox[{"#", ",", 
        RowBox[{"ImageSize", "\[Rule]", "350"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{"src", ",", "data", ",", "lowdata"}], "}"}]}], ";"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.697334471138101*^9, 3.697334511967051*^9}, {
   3.6973346343044853`*^9, 3.697334704458088*^9}, {3.697334741135241*^9, 
   3.697334840607267*^9}, {3.697334884569015*^9, 3.697334946854705*^9}, {
   3.697334977915736*^9, 3.6973350757089033`*^9}, {3.6973351296263103`*^9, 
   3.6973352900750933`*^9}, 3.6973353367397127`*^9, {3.697335463370133*^9, 
   3.697335919551503*^9}, {3.6973361572370157`*^9, 3.697336157600263*^9}, {
   3.697336188122603*^9, 3.6973362054968157`*^9}, {3.6973362648901443`*^9, 
   3.697336325947132*^9}, {3.697336394995802*^9, 3.6973364872370996`*^9}, {
   3.697336615263915*^9, 3.697336625570319*^9}, {3.697336713634108*^9, 
   3.697336763783518*^9}, {3.697336804662368*^9, 3.697336808043483*^9}, {
   3.69733687504081*^9, 3.697336879464242*^9}, {3.697337015790543*^9, 
   3.697337055911015*^9}, {3.697337085920752*^9, 3.697337157066628*^9}, {
   3.697337258650887*^9, 3.697337346368331*^9}, {3.697337528327692*^9, 
   3.6973375295553827`*^9}, {3.697337570568803*^9, 3.697337714677984*^9}, {
   3.697337755010696*^9, 3.697338056054327*^9}, {3.697338093748289*^9, 
   3.697338123345001*^9}, {3.6973415126802073`*^9, 3.697341584984538*^9}, {
   3.697341644983766*^9, 3.6973416492801247`*^9}, {3.697341684186781*^9, 
   3.697341709937179*^9}, {3.697341771729661*^9, 3.6973418003190193`*^9}, {
   3.69734183359134*^9, 3.6973419436667852`*^9}, {3.6973419798052473`*^9, 
   3.697341984831609*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"Ac\"\>", ",", 
   SliderBox[Dynamic[$CellContext`Ac], {-10, 10},
    ImageSize->1000], ",", 
   DynamicBox[ToBoxes[$CellContext`Ac, StandardForm],
    ImageSizeCache->{31., {1., 9.}}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.697341545766638*^9, {3.697341583544499*^9, 3.697341585295087*^9}, 
   3.697341649648821*^9, {3.697341690873424*^9, 3.697341710293582*^9}, {
   3.697341773773892*^9, 3.69734180065757*^9}, {3.6973418365062237`*^9, 
   3.697341842908609*^9}, {3.69734193261017*^9, 3.697341947890936*^9}, 
   3.697341985367723*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"Oc\"\>", ",", 
   SliderBox[Dynamic[$CellContext`Oc], {-100, 100},
    ImageSize->1000], ",", 
   DynamicBox[ToBoxes[$CellContext`Oc, StandardForm],
    ImageSizeCache->{16., {1., 9.}}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.697341545766638*^9, {3.697341583544499*^9, 3.697341585295087*^9}, 
   3.697341649648821*^9, {3.697341690873424*^9, 3.697341710293582*^9}, {
   3.697341773773892*^9, 3.69734180065757*^9}, {3.6973418365062237`*^9, 
   3.697341842908609*^9}, {3.69734193261017*^9, 3.697341947890936*^9}, 
   3.697341985378023*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"Am\"\>", ",", 
   SliderBox[Dynamic[$CellContext`Am], {-10, 10},
    ImageSize->1000], ",", 
   DynamicBox[ToBoxes[$CellContext`Am, StandardForm],
    ImageSizeCache->{31., {1., 9.}}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.697341545766638*^9, {3.697341583544499*^9, 3.697341585295087*^9}, 
   3.697341649648821*^9, {3.697341690873424*^9, 3.697341710293582*^9}, {
   3.697341773773892*^9, 3.69734180065757*^9}, {3.6973418365062237`*^9, 
   3.697341842908609*^9}, {3.69734193261017*^9, 3.697341947890936*^9}, 
   3.697341985384527*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"Om\"\>", ",", 
   SliderBox[Dynamic[$CellContext`Om], {-100, 100},
    ImageSize->1000], ",", 
   DynamicBox[ToBoxes[$CellContext`Om, StandardForm],
    ImageSizeCache->{16., {1., 9.}}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.697341545766638*^9, {3.697341583544499*^9, 3.697341585295087*^9}, 
   3.697341649648821*^9, {3.697341690873424*^9, 3.697341710293582*^9}, {
   3.697341773773892*^9, 3.69734180065757*^9}, {3.6973418365062237`*^9, 
   3.697341842908609*^9}, {3.69734193261017*^9, 3.697341947890936*^9}, 
   3.6973419853902273`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"f\"\>", ",", 
   SliderBox[Dynamic[$CellContext`f], {-10, 10},
    ImageSize->1000], ",", 
   DynamicBox[ToBoxes[$CellContext`f, StandardForm],
    ImageSizeCache->{40., {1., 9.}}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.697341545766638*^9, {3.697341583544499*^9, 3.697341585295087*^9}, 
   3.697341649648821*^9, {3.697341690873424*^9, 3.697341710293582*^9}, {
   3.697341773773892*^9, 3.69734180065757*^9}, {3.6973418365062237`*^9, 
   3.697341842908609*^9}, {3.69734193261017*^9, 3.697341947890936*^9}, 
   3.697341985395687*^9}],

Cell[BoxData[
 DynamicBox[ToBoxes[
   ListLinePlot[{
     $CellContext`Um[$CellContext`r], 
     HighpassFilter[
      LowpassFilter[$CellContext`Uam[$CellContext`r] \
$CellContext`Uc[$CellContext`r], 0.012], 0.012]}, ImageSize -> 1000, 
    PlotRange -> All], StandardForm],
  ImageSizeCache->{1000., {306., 311.}}]], "Output",
 CellChangeTimes->{
  3.697341545766638*^9, {3.697341583544499*^9, 3.697341585295087*^9}, 
   3.697341649648821*^9, {3.697341690873424*^9, 3.697341710293582*^9}, {
   3.697341773773892*^9, 3.69734180065757*^9}, {3.6973418365062237`*^9, 
   3.697341842908609*^9}, {3.69734193261017*^9, 3.697341947890936*^9}, 
   3.697341985401586*^9}]
}, Open  ]]
},
WindowSize->{1280, 721},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (July 28, \
2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 5991, 160, 462, "Input"],
Cell[6574, 184, 583, 12, 40, "Output"],
Cell[7160, 198, 585, 12, 40, "Output"],
Cell[7748, 212, 583, 12, 40, "Output"],
Cell[8334, 226, 587, 12, 40, "Output"],
Cell[8924, 240, 580, 12, 40, "Output"],
Cell[9507, 254, 663, 14, 632, "Output"]
}, Open  ]]
}
]
*)

